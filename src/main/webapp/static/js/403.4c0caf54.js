"use strict";(self["webpackChunkstu_admin"]=self["webpackChunkstu_admin"]||[]).push([[403],{4403:function(t,e,a){a.r(e),a.d(e,{default:function(){return z}});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"studentInfo",attrs:{id:"studentInfo"}},[e("div",{staticClass:"tableHeader",attrs:{id:"tableHeader"}},[e("el-row",{staticStyle:{height:"100%","margin-left":"10px"},attrs:{type:"flex",justify:"start",align:"middle",gutter:5}},[e("el-col",{attrs:{span:3}},[e("el-input",{attrs:{placeholder:"请输入学生姓名"},model:{value:t.nameInput,callback:function(e){t.nameInput=e},expression:"nameInput"}})],1),e("el-col",{attrs:{span:3}},[e("el-input",{attrs:{placeholder:"请输入专业"},model:{value:t.majorInput,callback:function(e){t.majorInput=e},expression:"majorInput"}})],1),e("el-col",{staticStyle:{"margin-left":"15px"},attrs:{span:3,pull:1}},[e("el-button",{attrs:{type:"primary",size:"medium",loading:t.searchLoading},on:{click:t.searchClick}},[t._v("查询")])],1)],1)],1),e("div",{staticClass:"table"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{stripe:"","highlight-current-row":"","show-header":t.showHeader,data:t.tableData,height:t.tableHeight}},[e("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("student-info-expand",{attrs:{"stu-name":t.row.name,"stu-id":t.row.studentid}})]}}])}),e("el-table-column",{attrs:{prop:"studentid",label:"学号"}}),e("el-table-column",{attrs:{prop:"name",label:"姓名"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{size:"medium"}},[t._v(t._s(a.row.name))])]}}])}),e("el-table-column",{attrs:{prop:"age",label:"年龄"}}),e("el-table-column",{attrs:{prop:"sex",label:"性别"}}),e("el-table-column",{attrs:{prop:"major",label:"专业"}}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.handleEdit(a.$index,a.row)}}},[t._v("编辑 ")]),e("el-button",{attrs:{size:"mini",type:"danger",loading:a.row.loading},on:{click:function(e){return t.handleDelete(a.$index,a.row)}}},[t._v("删除 ")])]}}])})],1)],1),e("el-dialog",{ref:"dialog",attrs:{title:"编辑学生信息",visible:t.dialogVisible,width:"30%","before-close":t.beforeDialClose,"destroy-on-close":""},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("student-info-edit",{ref:"stuEdit",on:{stuInfoEditCallBack:t.editCallBack}})],1)],1)},l=[],o=a(2996),i=a.n(o),r=a(5574),n=a.n(r),u=a(58);function d(){return(0,u.W)({url:"/stu-admin/student/selectAll",method:"get"})}function c(t){return(0,u.W)({url:"/stu-admin/student/selectByName",method:"get",params:{name:t}})}function m(t){return(0,u.W)({url:"/stu-admin/student/selectByMajor",method:"get",params:{major:t}})}function h(t){return(0,u.W)({url:"/stu-admin/student/deleteById",method:"get",params:{student_id:t}})}function f(t){return(0,u.W)({url:"/stu-admin/student/update",method:"post",data:t,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}})}var p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"expandInfo"},[e("div",{staticClass:"mainModule"},[e("el-row",{staticStyle:{width:"100%"},attrs:{type:"flex"}},[e("el-col",{staticClass:"table",attrs:{span:12}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],staticClass:"table",attrs:{"highlight-current-row":"","max-height":300,"show-header":!1,data:t.tableData}},[e("el-table-column",{attrs:{prop:"courseId",label:"课程id"}}),e("el-table-column",{attrs:{prop:"courseName",label:"课程名字"}}),e("el-table-column",{attrs:{prop:"courseScore",label:"学分"}}),e("el-table-column",{attrs:{prop:"courseTime",label:"时长"}})],1)],1),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"description"},[e("el-descriptions",{attrs:{title:"课程统计"}},[e("el-descriptions-item",{attrs:{label:"修读课程数"}},[t._v(t._s(t.courseTotal))]),e("el-descriptions-item",{attrs:{label:"修读总学分"}},[t._v(t._s(t.courseScores))])],1),e("div",{staticClass:"courseModify"},[e("el-button",{attrs:{type:"primary"},on:{click:t.modifyCourseClick}},[t._v("修改课程信息")])],1)],1)])],1)],1),e("el-dialog",{attrs:{title:"编辑学生课程信息",visible:t.dialogVisible,width:"70%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("student-course-modify",{attrs:{"stu-name":t.stuName,"stu-id":t.stuId,selectCourse:t.tableData}})],1)],1)},b=[],g=function(){var t=this,e=t._self._c;return e("div",{staticClass:"stuCourseModify"},[e("div",{staticClass:"courseTransfer"},[e("el-transfer",{attrs:{filterable:"",data:t.transferData,titles:["所有课程","已选课程"]},model:{value:t.selectValue,callback:function(e){t.selectValue=e},expression:"selectValue"}})],1),e("el-button",{staticClass:"modifyButton",attrs:{type:"primary",loading:t.modifyLoading},on:{click:t.modifyClick}},[t._v("修改")])],1)},v=[],D=(a(7658),{name:"studentCourseModify",props:{stuName:String,stuId:Number,selectCourse:Array},data(){return{allCourse:[{courseId:123456,name:"java程序设计"},{courseId:123457,name:"web程序设计"}],modifyLoading:!1,transferData:[],selectValue:[]}},methods:{modifyClick(){alert("click modify: "+this.selectValue)}},created(){},beforeMount(){let t={};for(let a of this.selectCourse)t[a.courseId]=a;console.log(t);let e=[];for(let a of this.allCourse){const s=a.courseId;void 0!==t[s]&&this.selectValue.push(s),e.push({key:s,label:a.name,disabled:!1})}this.transferData=e,console.log(e)}}),I=D,y=a(1001),x=(0,y.Z)(I,g,v,!1,null,"5947a5f0",null),C=x.exports,S={name:"StudentInfoExpand",components:{studentCourseModify:C},data(){return{dialogVisible:!1,tableLoading:!1,courseTotal:0,courseScores:0,tableData:[{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"}]}},props:{stuName:String,stuId:Number},created(){console.log("expand name: "+this.stuName+" id: "+this.stuId)},methods:{modifyCourseClick(){this.dialogVisible=!0}}},w=S,k=(0,y.Z)(w,p,b,!1,null,"35056970",null),j=k.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"stuEditForm"},[e("el-form",{attrs:{model:t.formData,"label-position":"right","label-width":"80px"}},[e("el-form-item",{attrs:{label:"学生姓名"}},[e("el-input",{staticClass:"formInput",model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),e("el-form-item",{attrs:{label:"年龄"}},[e("el-input",{model:{value:t.formData.age,callback:function(e){t.$set(t.formData,"age",e)},expression:"formData.age"}})],1),e("el-form-item",{attrs:{label:"性别"}},[e("el-select",{staticClass:"formInput",attrs:{placeholder:"请选择性别"},model:{value:t.formData.sex,callback:function(e){t.$set(t.formData,"sex",e)},expression:"formData.sex"}},[e("el-option",{attrs:{value:"男"}}),e("el-option",{attrs:{value:"女"}})],1)],1),e("el-form-item",{attrs:{label:"专业班级"}},[e("el-select",{staticClass:"formInput",attrs:{placeholder:"请选择活动专业"},model:{value:t.formData.major,callback:function(e){t.$set(t.formData,"major",e)},expression:"formData.major"}},t._l(this.majorData,(function(t){return e("el-option",{key:t.value,attrs:{value:t.value}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")])],1)],1)],1)},L=[];function E(){return(0,u.W)({url:"/stu-admin/clazz/selectAll"})}var T={name:"StudentInfoEdit",data(){return{hasSubmit:!1,majorData:[],formData:{studentid:"",name:"",age:"",sex:"",major:""}}},created(){E().then((t=>{if(!0===t.status){const e=t.data;let a=[];for(let t=0;t<e.length;t++)a.push({label:e[t].classname,value:e[t].classname});this.majorData=a}else i().warning("获取班级列表失败: "+t.message)}))},methods:{onSubmit(){f(this.formData).then((t=>{!0===t.success?(i().success("提交成功"),this.hasSubmit=!0,this.$emit("stuInfoEditCallBack",this.formData)):i().warning(t.message)}))}}},N=T,$=(0,y.Z)(N,_,L,!1,null,"757d769e",null),H=$.exports,V={name:"StudentInfo",components:{StudentInfoExpand:j,StudentInfoEdit:H},extends:n(),data(){return{dialogVisible:!1,tableLoading:!1,showHeader:!1,searchLoading:!1,originSelectData:{},selectIndex:-1,nameInput:"",majorInput:"",tableHeight:0,tableData:[{studentid:123456,name:"yong1",age:18,sex:"男",major:"软件工程"},{studentid:123457,name:"yong2",age:19,sex:"男",major:"软件工程"},{studentid:123458,name:"yong3",age:20,sex:"男",major:"软件工程"}]}},mounted(){this.$refs.dialog.rendered=!0},created(){console.log("table length: "+this.tableData.length),this.showHeader=0!==this.tableData.length,this.$nextTick((()=>{this.tableHeight=document.getElementById("studentInfo").offsetHeight-document.getElementById("tableHeader").offsetHeight})),this.tableLoading=!0,d().then((t=>{!0===t.status&&(this.tableData=t.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.tableLoading=!1}))},methods:{beforeDialClose(t){const e=this.$refs.stuEdit.hasSubmit;e||(this.$refs.stuEdit.formData.studentid=this.originSelectData.studentid,this.$refs.stuEdit.formData.name=this.originSelectData.name,this.$refs.stuEdit.formData.age=this.originSelectData.age,this.$refs.stuEdit.formData.major=this.originSelectData.major,this.$refs.stuEdit.formData.sex=this.originSelectData.sex),t()},editCallBack(t){this.tableData[this.selectIndex]=t,console.log(this.tableData)},addLoadingToResp(){for(let t=0;t<this.tableData.length;t++)this.$set(this.tableData[t],"loading",!1)},handleEdit(t,e){this.selectIndex=t,Object.assign(this.originSelectData,e),this.$refs.stuEdit.formData=e,this.dialogVisible=!0},handleDelete(t,e){e.loading=!0,h(e.studentid).then((a=>{!0!==a.success?i().warning(a.message):i().success("删除成功"),e.loading=!1,this.tableData.splice(t,1)}))},searchClick(){this.searchLoading=!0,""!==this.nameInput?c(this.nameInput).then((t=>{!0===t.status&&(this.tableData=t.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.searchLoading=!1})):""!==this.majorInput?m(this.majorInput).then((t=>{!0===t.status&&(this.tableData=t.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.searchLoading=!1})):d().then((t=>{!0===t.status&&(this.tableData=t.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.tableLoading=!1,this.searchLoading=!1}))}}},B=V,M=(0,y.Z)(B,s,l,!1,null,"3ff290f2",null),z=M.exports}}]);
//# sourceMappingURL=403.4c0caf54.js.map