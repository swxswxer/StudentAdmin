"use strict";(self["webpackChunkstu_admin"]=self["webpackChunkstu_admin"]||[]).push([[351],{9351:function(e,t,a){a.r(t),a.d(t,{default:function(){return z}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"studentInfo",attrs:{id:"studentInfo"}},[t("div",{staticClass:"tableHeader",attrs:{id:"tableHeader"}},[t("el-row",{staticStyle:{height:"100%","margin-left":"10px"},attrs:{type:"flex",justify:"start",align:"middle",gutter:5}},[t("el-col",{attrs:{span:3}},[t("el-input",{attrs:{placeholder:"请输入学生姓名"},model:{value:e.nameInput,callback:function(t){e.nameInput=t},expression:"nameInput"}})],1),t("el-col",{attrs:{span:3}},[t("el-input",{attrs:{placeholder:"请输入专业"},model:{value:e.majorInput,callback:function(t){e.majorInput=t},expression:"majorInput"}})],1),t("el-col",{staticStyle:{"margin-left":"15px"},attrs:{span:3,pull:1}},[t("el-button",{attrs:{type:"primary",size:"medium",loading:e.searchLoading},on:{click:e.searchClick}},[e._v("查询")])],1)],1)],1),t("div",{staticClass:"table"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{stripe:"","highlight-current-row":"","show-header":e.showHeader,data:e.tableData,height:e.tableHeight}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("student-info-expand",{attrs:{"stu-name":e.row.name,"stu-id":e.row.studentid}})]}}])}),t("el-table-column",{attrs:{prop:"studentid",label:"学号"}}),t("el-table-column",{attrs:{prop:"name",label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{size:"medium"}},[e._v(e._s(a.row.name))])]}}])}),t("el-table-column",{attrs:{prop:"age",label:"年龄"}}),t("el-table-column",{attrs:{prop:"sex",label:"性别"}}),t("el-table-column",{attrs:{prop:"major",label:"专业"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.$index,a.row)}}},[e._v("编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger",loading:a.row.loading},on:{click:function(t){return e.handleDelete(a.$index,a.row)}}},[e._v("删除 ")])]}}])})],1)],1),t("el-dialog",{ref:"dialog",attrs:{title:"编辑学生信息",visible:e.dialogVisible,width:"30%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("student-info-edit",{ref:"stuEdit",on:{stuInfoEditCallBack:e.editCallBack}})],1)],1)},l=[],o=a(2996),i=a.n(o),n=a(5574),r=a.n(n),u=a(58);function d(){return(0,u.W)({url:"/stu-admin/student/selectAll",method:"get"})}function c(e){return(0,u.W)({url:"/stu-admin/student/selectByName",method:"get",params:{name:e}})}function m(e){return(0,u.W)({url:"/stu-admin/student/selectByMajor",method:"get",params:{major:e}})}function h(e){return(0,u.W)({url:"/stu-admin/student/deleteById",method:"get",params:{student_id:e}})}function p(e){return(0,u.W)({url:"/stu-admin/student/update",method:"post",data:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}var f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"expandInfo"},[t("div",{staticClass:"mainModule"},[t("el-row",{staticStyle:{width:"100%"},attrs:{type:"flex"}},[t("el-col",{staticClass:"table",attrs:{span:12}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticClass:"table",attrs:{"highlight-current-row":"","max-height":300,"show-header":!1,data:e.tableData}},[t("el-table-column",{attrs:{prop:"courseId",label:"课程id"}}),t("el-table-column",{attrs:{prop:"courseName",label:"课程名字"}}),t("el-table-column",{attrs:{prop:"courseScore",label:"学分"}}),t("el-table-column",{attrs:{prop:"courseTime",label:"时长"}})],1)],1),t("el-col",{attrs:{span:12}},[t("div",{staticClass:"description"},[t("el-descriptions",{attrs:{title:"课程统计"}},[t("el-descriptions-item",{attrs:{label:"修读课程数"}},[e._v(e._s(e.courseTotal))]),t("el-descriptions-item",{attrs:{label:"修读总学分"}},[e._v(e._s(e.courseScores))])],1),t("div",{staticClass:"courseModify"},[t("el-button",{attrs:{type:"primary"},on:{click:e.modifyCourseClick}},[e._v("修改课程信息")])],1)],1)])],1)],1),t("el-dialog",{attrs:{title:"编辑学生课程信息",visible:e.dialogVisible,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("student-course-modify",{attrs:{"stu-name":e.stuName,"stu-id":e.stuId,selectCourse:e.tableData}})],1)],1)},b=[],g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"stuCourseModify"},[t("div",{staticClass:"courseTransfer"},[t("el-transfer",{attrs:{filterable:"",data:e.transferData,titles:["所有课程","已选课程"]},model:{value:e.selectValue,callback:function(t){e.selectValue=t},expression:"selectValue"}})],1),t("el-button",{staticClass:"modifyButton",attrs:{type:"primary",loading:e.modifyLoading},on:{click:e.modifyClick}},[e._v("修改")])],1)},v=[],I=(a(7658),{name:"studentCourseModify",props:{stuName:String,stuId:Number,selectCourse:Array},data(){return{allCourse:[{courseId:123456,name:"java程序设计"},{courseId:123457,name:"web程序设计"}],modifyLoading:!1,transferData:[],selectValue:[]}},methods:{modifyClick(){alert("click modify: "+this.selectValue)}},created(){},beforeMount(){let e={};for(let a of this.selectCourse)e[a.courseId]=a;console.log(e);let t=[];for(let a of this.allCourse){const s=a.courseId;void 0!==e[s]&&this.selectValue.push(s),t.push({key:s,label:a.name,disabled:!1})}this.transferData=t,console.log(t)}}),y=I,D=a(1001),x=(0,D.Z)(y,g,v,!1,null,"5947a5f0",null),C=x.exports,w={name:"StudentInfoExpand",components:{studentCourseModify:C},data(){return{dialogVisible:!1,tableLoading:!1,courseTotal:0,courseScores:0,tableData:[{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"},{courseId:123456,courseName:"java 程序设计",courseScore:4,courseTime:"8周"}]}},props:{stuName:String,stuId:Number},created(){console.log("expand name: "+this.stuName+" id: "+this.stuId)},methods:{modifyCourseClick(){this.dialogVisible=!0}}},k=w,j=(0,D.Z)(k,f,b,!1,null,"35056970",null),S=j.exports,_=function(){var e=this,t=e._self._c;return t("div",{staticClass:"stuEditForm"},[t("el-form",{attrs:{model:e.formData,"label-position":"right","label-width":"80px"}},[t("el-form-item",{attrs:{label:"学生姓名"}},[t("el-input",{staticClass:"formInput",model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),t("el-form-item",{attrs:{label:"年龄"}},[t("el-input",{model:{value:e.formData.age,callback:function(t){e.$set(e.formData,"age",t)},expression:"formData.age"}})],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-select",{staticClass:"formInput",attrs:{placeholder:"请选择性别"},model:{value:e.formData.sex,callback:function(t){e.$set(e.formData,"sex",t)},expression:"formData.sex"}},[t("el-option",{attrs:{value:"男"}}),t("el-option",{attrs:{value:"女"}})],1)],1),t("el-form-item",{attrs:{label:"专业班级"}},[t("el-select",{staticClass:"formInput",attrs:{placeholder:"请选择活动专业"},model:{value:e.formData.major,callback:function(t){e.$set(e.formData,"major",t)},expression:"formData.major"}},e._l(this.majorData,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)],1)},L=[];function T(){return(0,u.W)({url:"/stu-admin/clazz/selectAll"})}var N={name:"StudentInfoEdit",data(){return{majorData:[],formData:{studentid:"",name:"",age:"",sex:"",major:""}}},created(){T().then((e=>{if(!0===e.status){const t=e.data;let a=[];for(let e=0;e<t.length;e++)a.push({label:t[e].classname,value:t[e].classname});this.majorData=a}else i().warning("获取班级列表失败: "+e.message)}))},props:{stuInfo:Object},methods:{onSubmit(){p(this.formData).then((e=>{!0===e.success?i().success("提交成功"):i().warning(e.message)})),this.$emit("stuInfoEditCallBack",this.formData)}}},H=N,V=(0,D.Z)(H,_,L,!1,null,"47c3c0b0",null),E=V.exports,$={name:"StudentInfo",components:{StudentInfoExpand:S,StudentInfoEdit:E},extends:r(),data(){return{dialogVisible:!1,tableLoading:!1,showHeader:!1,searchLoading:!1,selectIndex:-1,nameInput:"",majorInput:"",tableHeight:0,tableData:[{studentid:123456,name:"yong1",age:18,sex:"男",major:"软件工程"},{studentid:123457,name:"yong2",age:19,sex:"男",major:"软件工程"},{studentid:123458,name:"yong3",age:20,sex:"男",major:"软件工程"}]}},mounted(){this.$refs.dialog.rendered=!0},created(){console.log("table length: "+this.tableData.length),this.showHeader=0!==this.tableData.length,this.$nextTick((()=>{this.tableHeight=document.getElementById("studentInfo").offsetHeight-document.getElementById("tableHeader").offsetHeight})),this.tableLoading=!0,d().then((e=>{!0===e.status&&(this.tableData=e.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.tableLoading=!1}))},methods:{editCallBack(e){this.tableData[this.selectIndex]=e,console.log(this.tableData)},addLoadingToResp(){for(let e=0;e<this.tableData.length;e++)this.$set(this.tableData[e],"loading",!1)},handleEdit(e,t){this.selectIndex=e,this.$refs.stuEdit.formData=t,this.dialogVisible=!0},handleDelete(e,t){t.loading=!0,h(t.studentid).then((a=>{!0!==a.success?i().warning(a.message):i().success("删除成功"),t.loading=!1,this.tableData.splice(e,1)}))},searchClick(){this.searchLoading=!0,""!==this.nameInput?c(this.nameInput).then((e=>{!0===e.status&&(this.tableData=e.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.searchLoading=!1})):""!==this.majorInput?m(this.majorInput).then((e=>{!0===e.status&&(this.tableData=e.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.searchLoading=!1})):d().then((e=>{!0===e.status&&(this.tableData=e.data,this.addLoadingToResp()),this.showHeader=0!==this.tableData.length,this.tableLoading=!1,this.searchLoading=!1}))}}},B=$,M=(0,D.Z)(B,s,l,!1,null,"0ce52de1",null),z=M.exports}}]);
//# sourceMappingURL=351.62de9058.js.map